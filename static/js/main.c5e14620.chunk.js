(this["webpackJsonptotsystems-test"]=this["webpackJsonptotsystems-test"]||[]).push([[0],{123:function(e,t,a){e.exports=a(162)},161:function(e,t,a){},162:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),l=a.n(c),o=a(27),i=a(228),u=a(14),s=a(12),m=a(22),d=a(35),p=a(214),f=a(211),h=a(163),b=a(213),g=a(209),E=a(233),v=a(231),O=a(15),j=a(206),y=a(215),w=a(216),k=a(43),x=a(217),S=a(96),C=a.n(S),N=a(97),W=a.n(N),T=a(218),B=a(105),M=a(212),P=a(47),A=Object(P.b)({name:"auth",initialState:{user:{},isAuthenticated:!1},reducers:{logIn:function(e,t){var a=t.payload;e.user=a,e.isAuthenticated=!0},logOut:function(e){e.user={},e.isAuthenticated=!1}}}),I=A.actions,D=I.logIn,F=I.logOut,Y=A.reducer,J=Object(j.a)((function(e){return{root:{flexGrow:1,display:"flex"},drawer:Object(d.a)({},e.breakpoints.up("sm"),{width:240,flexShrink:0}),appBar:Object(d.a)({},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(240,"px)"),marginLeft:240}),menuButton:Object(d.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),title:{flexGrow:1},drawerPaper:{width:240}}}));function L(){var e=Object(n.useState)(!1),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(null),i=Object(m.a)(l,2),d=i[0],j=i[1],S=J(),N=Boolean(d),P=Object(s.g)(),A=Object(u.b)(),I=Object(O.a)(),D=function(){c(!a)},Y=function(){j(null)},L=void 0!==window?function(){return document.body}:void 0,R=r.a.createElement("div",null,r.a.createElement("div",{className:S.toolbar}),r.a.createElement(g.a,null),r.a.createElement(g.a,null),r.a.createElement(f.a,null,[{label:"\u0412\u0441\u044f\u043a\u043e\u0435 \ud83d\ude43",link:"/chat/fun"},{label:"\u0420\u0430\u0431\u043e\u0447\u0438\u0439 \u0447\u0430\u0442 \ud83d\udc69\u200d\ud83d\udcbb",link:"/chat/work"}].map((function(e){var t=e.label,a=e.link;return r.a.createElement(M.a,{key:t,component:o.b,to:a},r.a.createElement(h.a,{button:!0,key:t},r.a.createElement(b.a,{primary:t})))}))));return r.a.createElement("header",{className:S.root},r.a.createElement(p.a,null),r.a.createElement(y.a,{position:"fixed",className:S.appBar},r.a.createElement(w.a,null,r.a.createElement(x.a,{edge:"start",className:S.menuButton,color:"inherit","aria-label":"menu",onClick:D},r.a.createElement(C.a,null)),r.a.createElement(k.a,{variant:"h6",className:S.title},"\u041a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u0430\u044f \u0441\u0435\u0442\u044c Planktonics \ud83d\ude03\ud83d\udcac"),r.a.createElement("div",null,r.a.createElement(x.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){j(e.currentTarget)},color:"inherit"},r.a.createElement(W.a,null)),r.a.createElement(B.a,{id:"menu-appbar",anchorEl:d,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:N,onClose:Y},r.a.createElement(T.a,{onClick:Y},r.a.createElement(M.a,{component:o.b,to:"/profile"},"\u041f\u0440\u043e\u0444\u0438\u043b\u044c")),r.a.createElement(T.a,{style:{color:I.palette.error.main},onClick:function(){Y(),A(function(e){return function(t){t(F()),e.push("/login")}}(P))}},"\u0412\u044b\u0439\u0442\u0438"))))),r.a.createElement("nav",{className:S.drawer},r.a.createElement(v.a,{smUp:!0,implementation:"css"},r.a.createElement(E.a,{container:L,variant:"temporary",anchor:"rtl"===I.direction?"right":"left",open:a,onClose:D,classes:{paper:S.drawerPaper},ModalProps:{keepMounted:!0}},R)),r.a.createElement(v.a,{xsDown:!0,implementation:"css"},r.a.createElement(E.a,{classes:{paper:S.drawerPaper},variant:"permanent",open:!0},R))))}function R(){return r.a.createElement(L,null)}var G=a(65);function U(e){var t=e.children,a=Object(G.a)(e,["children"]),n=Object(u.c)((function(e){return e.auth.isAuthenticated}));return r.a.createElement(s.b,Object.assign({},a,{render:function(e){var a=e.location;return n?t:r.a.createElement(s.a,{to:{pathname:"/login",state:{from:a}}})}}))}var q=a(222),z=a(229),H=a(219),V=Object(j.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function $(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),o=Object(m.a)(l,2),i=o[0],d=o[1],f=V(),h=Object(u.b)(),b=Object(s.g)();return r.a.createElement(H.a,{component:"main",maxWidth:"xs"},r.a.createElement(p.a,null),r.a.createElement("div",{className:f.paper},r.a.createElement(k.a,{component:"h1",variant:"h5",align:"center"},"\u041a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u0430\u044f \u0441\u0435\u0442\u044c Planktonics ",r.a.createElement("br",null),"\ud83d\ude03\ud83d\udcac"),r.a.createElement("form",{className:f.form,noValidate:!0,onSubmit:function(e){e.preventDefault(),h(function(e,t){return function(a){a(D(e)),t.push("/")}}({login:a,setLogin:c},b))}},r.a.createElement(z.a,{value:a,onChange:function(e){return c(e.target.value)},variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"login",label:"\u041b\u043e\u0433\u0438\u043d",name:"login",autoFocus:!0}),r.a.createElement(z.a,{value:i,onChange:function(e){return d(e.target.value)},variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password"}),r.a.createElement(q.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:f.submit},"\u0412\u043e\u0439\u0442\u0438"))))}var K=Object(j.a)((function(e){return{main:Object(d.a)({flexGrow:1,marginTop:64,paddingTop:e.spacing(3)},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(240,"px)"),marginLeft:240})}}));function Q(e){var t=e.children,a=K();return r.a.createElement("main",{className:a.main},t)}function X(){var e=Object(u.c)((function(e){return e.auth.user}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement(Q,null,r.a.createElement(k.a,{variant:"h4",align:"center",style:{display:"block"},gutterBottom:!0},"\u0422\u0432\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \ud83d\udc66\ud83c\udffb\ud83d\udc67\ud83c\udffd\ud83d\ude3a"),r.a.createElement(k.a,{variant:"body2"},"\u041b\u043e\u0433\u0438\u043d: "),r.a.createElement(k.a,{variant:"body1"},r.a.createElement("strong",null,e.login))))}var Z=a(108),_=a(74),ee=a.n(_),te=a(98),ae=a(76),ne=a(99),re=a.n(ne),ce=Object(P.b)({name:"chat",initialState:{chats:{work:[],fun:[]}},reducers:{send:function(e,t){var a=t.payload;e.chats[a.chat]=[].concat(Object(ae.a)(e.chats[a.chat]),[a.message])},remove:function(e,t){var a=t.payload;e.chats[a.chat]=e.chats[a.chat].filter((function(e){return e.id!==a.id}))},edit:function(e,t){var a=t.payload;e.chats[a.chat]=e.chats[a.chat].map((function(e){return e.id===a.message.id?a.message:e}))},update:function(e,t){var a=t.payload;Object.keys(a).forEach((function(t){a[t].forEach((function(a){void 0===e.chats[t].find((function(e){return e.id===a.id}))&&(e.chats[t]=[].concat(Object(ae.a)(e.chats[t]),[a]))}))}))}}}),le=ce.actions,oe=le.send,ie=le.remove,ue=le.edit,se=le.update,me=ce.reducer,de=a(101),pe=a.n(de),fe=a(100),he=a.n(fe),be=Object(j.a)((function(e){return{message:{color:e.palette.text.primary,backgroundColor:pe.a[100],padding:e.spacing(1),marginTop:e.spacing(1),marginLeft:function(e){return e.currentUser?"auto":0},maxWidth:"50%",overflowWrap:"break-word",borderRadius:e.shape.borderRadius},meta:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"}}}));function ge(e){var t=e.message,a=e.onClick,n=Object(u.c)((function(e){return e.auth.user})),c=be({currentUser:n.login===t.sender});return r.a.createElement("div",{className:c.message,onClick:function(){return a(t)}},r.a.createElement(k.a,{variant:"h6",component:"span",color:"textPrimary"},t.text),r.a.createElement("div",{className:c.meta},r.a.createElement(k.a,{variant:"body2",component:"span",color:"textSecondary"},t.sender),r.a.createElement(k.a,{variant:"body2",component:"span",color:"textSecondary"},he()(t.date).format("DD/MM/YYYY HH:mm"))))}var Ee=a(102),ve=a.n(Ee),Oe=a(223),je=a(232),ye=a(220),we=a(221),ke=a(230);function xe(e){var t=e.chatTitle,a=e.onSubmit,c=(Object(G.a)(e,["chatTitle","onSubmit"]),Object(n.useState)("")),l=Object(m.a)(c,2),o=l[0],i=l[1],s=Object(u.c)((function(e){return e.auth.user}));return r.a.createElement(we.a,null,r.a.createElement(je.a,{htmlFor:"standard-adornment-password"},"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."),r.a.createElement(ye.a,{id:"standard-adornment-password",type:"text",value:o,onChange:function(e){i(e.target.value)},endAdornment:r.a.createElement(Oe.a,{position:"end"},r.a.createElement(x.a,{disapled:!o.length,onClick:function(){o.length&&(i(""),a({chat:t,message:{id:Object(ke.a)(),text:o,sender:s.login,data:Date.now()}}))}},r.a.createElement(ve.a,null)))}))}var Se=a(75),Ce=a(225),Ne=a(224),We=a(227),Te=a(226);function Be(e){var t=e.open,a=e.onClose,c=e.message,l=e.chat,o=Object(n.useState)(c.text),i=Object(m.a)(o,2),s=i[0],d=i[1],p=Object(u.b)();return r.a.createElement(Ne.a,{open:t,onClose:a,maxWidth:"sm",fullWidth:!0},r.a.createElement(Ce.a,{id:"form-dialog-title"},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"),r.a.createElement(Te.a,null,r.a.createElement(z.a,{value:s,onChange:function(e){return d(e.target.value)},autoFocus:!0,margin:"dense",label:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f",type:"text",fullWidth:!0})),r.a.createElement(We.a,null,r.a.createElement(q.a,{onClick:function(){a(),p(function(e){var t=e.chat,a=e.id;return function(e){e(ie({chat:t,id:a}))}}({chat:l,id:c.id}))},color:"primary"},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),r.a.createElement(q.a,{onClick:a},"\u041e\u0442\u043c\u0435\u043d\u0430"),r.a.createElement(q.a,{onClick:function(){a(),p(function(e){var t=e.chat,a=e.message;return function(e){e(ue({chat:t,message:a}))}}({chat:l,message:Object(Se.a)(Object(Se.a)({},c),{},{text:s})}))},color:"primary"},"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c")))}var Me=Object(j.a)((function(e){return{root:{position:"relative"},paper:{height:"75vh",padding:e.spacing(1),paddingBottom:e.spacing(5),overflowY:"scroll"},inputMessage:{width:"100%"},scrollAnchor:{marginTop:100}}}));function Pe(){var e=Object(n.useState)(null),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(s.h)().title,o=Me(),i=Object(u.b)(),d=Object(u.c)((function(e){return e.chat.chats[l]})),p=Object(n.useRef)(null),f=function(e){c(e)},h=function(){p.current.scrollIntoView({behavior:"smooth"})};Object(n.useEffect)((function(){h()}),[]);return Object(n.useEffect)((function(){i(function(){var e=Object(te.a)(ee.a.mark((function e(t){var a;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re.a.get("/TOTSystems-test/initialMessages.json");case 3:a=e.sent,t(se(a.data)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement(Q,null,r.a.createElement(H.a,{maxWidth:"md",className:o.root},r.a.createElement(Z.a,{className:o.paper},d&&d.map((function(e){return r.a.createElement(ge,{message:e,onClick:f})})),r.a.createElement("div",{ref:p,className:o.scrollAnchor})),r.a.createElement(xe,{className:o.inputMessage,chatTitle:l,onSubmit:function(e){i(function(e){var t=e.chat,a=e.message;return function(e){e(oe({chat:t,message:a}))}}(e)),h()}})),a&&r.a.createElement(Be,{open:null!==a,onClose:function(){c(null)},chat:l,message:a})))}function Ae(){return r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/login"},r.a.createElement($,null)),r.a.createElement(U,{exact:!0,path:"/"},r.a.createElement(R,null)),r.a.createElement(U,{exact:!0,path:"/profile"},r.a.createElement(X,null)),r.a.createElement(U,{exact:!0,path:"/chat/:title"},r.a.createElement(Pe,null)))}var Ie=function(){return r.a.createElement(Ae,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var De=a(103),Fe=a.n(De),Ye=function(){try{var e=localStorage.getItem("state");return null===e?void 0:JSON.parse(e)}catch(t){return}}(),Je=Object(P.a)({reducer:{auth:Y,chat:me},preloadedState:Ye});Je.subscribe(Fe()((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(a){console.error("\u041d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435")}}(Je.getState())}),1e3));var Le=Je,Re=a(104),Ge=Object(Re.a)({palette:{primary:{main:"#1f2233"},secondary:{main:"#ffff33"}}});a(161);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,null,r.a.createElement(u.a,{store:Le},r.a.createElement(i.a,{theme:Ge},r.a.createElement(Ie,null))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[123,1,2]]]);
//# sourceMappingURL=main.c5e14620.chunk.js.map